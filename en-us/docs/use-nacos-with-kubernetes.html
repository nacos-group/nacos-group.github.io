<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="nacos,kubernetes" />
	<meta name="description" content="This project contains a Nacos Docker image meant to facilitate the deployment of Nacos on Kubernetes via StatefulSets." />
	<!-- 网页标签标题 -->
	<title>Kubernetes Nacos</title>
	<link rel="shortcut icon" href="https://img.alicdn.com/tfs/TB1hgJpHAPoK1RjSZKbXXX1IXXa-64-64.png"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot="" data-reactid="1" data-react-checksum="205021321"><header class="header-container header-container-normal" data-reactid="2"><div class="header-body" data-reactid="3"><a href="/en-us/index.html" data-reactid="4"><img class="logo" src="/img/nacos_colorful.png" data-reactid="5"/></a><div class="search search-normal" data-reactid="6"><span class="icon-search" data-reactid="7"></span></div><span class="language-switch language-switch-normal" data-reactid="8">中</span><div class="header-menu" data-reactid="9"><img class="header-menu-toggle" src="/img/menu_gray.png" data-reactid="10"/><ul data-reactid="11"><li class="menu-item menu-item-normal" data-reactid="12"><span data-reactid="13"><a href="/en-us/index.html" data-reactid="14">HOME</a></span></li><li class="menu-item menu-item-normal menu-item-normal-active" data-reactid="15"><span data-reactid="16"><a href="/en-us/docs/quick-start.html" data-reactid="17">DOCS</a></span></li><li class="menu-item menu-item-normal" data-reactid="18"><div class="nav-container" data-reactid="19"><div class="word" data-reactid="20"><a data-reactid="21">SOLUTIONS</a><img class="menu-img" src="https://img.alicdn.com/tfs/TB1esl_m.T1gK0jSZFrXXcNCXXa-200-200.png" data-reactid="22"/></div><ul class="sub-nav-container" style="width:290px;" data-reactid="23"><li data-reactid="24"><a href="https://cn.aliyun.com/product/aliware/mse?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="25">Microservice Solution</a></li><li data-reactid="26"><a href="https://cn.aliyun.com/product/aliware/sae?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="27">Microservice on Serverless Solution</a></li><li data-reactid="28"><a href="https://www.aliyun.com/product/edas?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="29">PaaS Solution</a></li><li data-reactid="30"><a href="https://www.aliyun.com/aliware/txc?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="31">Distributed transaction Solution</a></li><li data-reactid="32"><a href="https://www.aliyun.com/product/ahas?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="33">High-availability Solution</a></li><li data-reactid="34"><a href="https://www.aliyun.com/product/servicemesh?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="35">Service mesh Solution</a></li></ul><!-- react-text: 36 --> <!-- /react-text --></div></li><li class="menu-item menu-item-normal" data-reactid="37"><span data-reactid="38"><a href="https://cn.aliyun.com/product/aliware/mse?spm=nacos-website.topbar.0.0.0" data-reactid="39">NACOS IN CLOUD</a><img class="menu-img" src="https://img.alicdn.com/tfs/TB1esl_m.T1gK0jSZFrXXcNCXXa-200-200.png" data-reactid="40"/></span></li><li class="menu-item menu-item-normal" data-reactid="41"><span data-reactid="42"><a href="https://developer.aliyun.com/topic/download?id=8230" data-reactid="43">E-BOOK</a><img class="menu-img" src="https://img.alicdn.com/tfs/TB1esl_m.T1gK0jSZFrXXcNCXXa-200-200.png" data-reactid="44"/></span></li><li class="menu-item menu-item-normal" data-reactid="45"><span data-reactid="46"><a href="/en-us/blog" data-reactid="47">BLOG</a></span></li><li class="menu-item menu-item-normal" data-reactid="48"><span data-reactid="49"><a href="/en-us/community" data-reactid="50">COMMUNITY</a></span></li><li class="menu-item menu-item-normal" data-reactid="51"><span data-reactid="52"><a href="http://console.nacos.io/nacos/index.html" data-reactid="53">DEMO-CONSOLE</a></span></li></ul></div></div></header><div class="bar" data-reactid="54"><div class="bar-body" data-reactid="55"><img src="/img/docs.png" class="front-img" data-reactid="56"/><div class="bar-title" data-reactid="57"><span data-reactid="58">Documentation</span><div class="bone bone-light" data-reactid="59"></div></div><img src="/img/docs.png" class="back-img" data-reactid="60"/></div></div><section class="content-section" data-reactid="61"><div class="content-body" data-reactid="62"><div class="sidemenu" data-reactid="63"><div class="sidemenu-toggle" data-reactid="64"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png" data-reactid="65"/></div><ul data-reactid="66"><li class="menu-item menu-item-level-1" data-reactid="67"><span data-reactid="68">Nacos </span><ul data-reactid="69"><li style="height:180px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="70"><span data-reactid="71"><!-- react-text: 72 -->What is Nacos<!-- /react-text --><img style="transform:rotate(0deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="73"/></span><ul data-reactid="74"><li class="menu-item menu-item-level-3" data-reactid="75"><a href="/en-us/docs/what-is-nacos.html" target="_self" data-reactid="76">What is Nacos</a></li><li class="menu-item menu-item-level-3" data-reactid="77"><a href="/en-us/docs/concepts.html" target="_self" data-reactid="78">Concepts</a></li><li class="menu-item menu-item-level-3" data-reactid="79"><a href="/en-us/docs/architecture.html" target="_self" data-reactid="80">Architecure</a></li><li class="menu-item menu-item-level-3" data-reactid="81"><a href="/en-us/docs/feature-list.html" target="_self" data-reactid="82">Feature list</a></li></ul></li><li style="height:324px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="83"><span data-reactid="84"><!-- react-text: 85 -->Quick Start<!-- /react-text --><img style="transform:rotate(0deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="86"/></span><ul data-reactid="87"><li class="menu-item menu-item-level-3" data-reactid="88"><a href="/en-us/docs/quick-start.html" target="_self" data-reactid="89">Nacos</a></li><li class="menu-item menu-item-level-3" data-reactid="90"><a href="/en-us/docs/quick-start-spring.html" target="_self" data-reactid="91">Nacos Spring</a></li><li class="menu-item menu-item-level-3" data-reactid="92"><a href="/en-us/docs/quick-start-spring-boot.html" target="_self" data-reactid="93">Nacos Spring Boot</a></li><li class="menu-item menu-item-level-3" data-reactid="94"><a href="/en-us/docs/quick-start-spring-cloud.html" target="_self" data-reactid="95">Nacos Spring Cloud</a></li><li class="menu-item menu-item-level-3" data-reactid="96"><a href="/en-us/docs/quick-start-docker.html" target="_self" data-reactid="97">Nacos Docker</a></li><li class="menu-item menu-item-level-3" data-reactid="98"><a href="/en-us/docs/use-nacos-with-dubbo.html" target="_self" data-reactid="99">Nacos with Dubbo</a></li><li class="menu-item menu-item-level-3" data-reactid="100"><a href="/en-us/docs/use-nacos-with-kubernetes.html" target="_self" data-reactid="101">Nacos with K8s</a></li><li class="menu-item menu-item-level-3" data-reactid="102"><a href="/en-us/docs/nacos-sync.html" target="_self" data-reactid="103">Nacos Sync</a></li></ul></li><li style="height:288px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="104"><span data-reactid="105"><!-- react-text: 106 -->User Guide<!-- /react-text --><img style="transform:rotate(0deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="107"/></span><ul data-reactid="108"><li class="menu-item menu-item-level-3" data-reactid="109"><a href="/en-us/docs/sdk.html" target="_self" data-reactid="110">Java SDK</a></li><li class="menu-item menu-item-level-3" data-reactid="111"><a href="/en-us/docs/other-language.html" target="_self" data-reactid="112">Other Language</a></li><li class="menu-item menu-item-level-3" data-reactid="113"><a href="/en-us/docs/open-api.html" target="_self" data-reactid="114">Open-API</a></li><li class="menu-item menu-item-level-3" data-reactid="115"><a href="/en-us/docs/nacos-spring.html" target="_self" data-reactid="116">Nacos Spring</a></li><li class="menu-item menu-item-level-3" data-reactid="117"><a href="/en-us/docs/system-configurations.html" target="_self" data-reactid="118">Nacos System Configurations</a></li><li class="menu-item menu-item-level-3" data-reactid="119"><a href="/en-us/docs/auth.html" target="_self" data-reactid="120">Authentication</a></li><li class="menu-item menu-item-level-3" data-reactid="121"><a href="/en-us/docs/faq.html" target="_self" data-reactid="122">FAQ</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="123"><span data-reactid="124"><!-- react-text: 125 -->Admin Guide<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="126"/></span><ul data-reactid="127"><li class="menu-item menu-item-level-3" data-reactid="128"><a href="/en-us/docs/deployment.html" target="_self" data-reactid="129">Deployment Guide</a></li><li class="menu-item menu-item-level-3" data-reactid="130"><a href="/en-us/docs/cluster-mode-quick-start.html" target="_self" data-reactid="131">Cluster Mode Deployment</a></li><li class="menu-item menu-item-level-3" data-reactid="132"><a href="/en-us/docs/management-api.html" target="_self" data-reactid="133">Management OpenAPI</a></li><li class="menu-item menu-item-level-3" data-reactid="134"><a href="/en-us/docs/console-guide.html" target="_self" data-reactid="135">Admin Console Guide</a></li><li class="menu-item menu-item-level-3" data-reactid="136"><a href="/en-us/docs/monitor-guide.html" target="_self" data-reactid="137">Nacos Monitor Guide</a></li><li class="menu-item menu-item-level-3" data-reactid="138"><a href="/en-us/docs/nacos-config-benchmark.html" target="_self" data-reactid="139">Nacos Config Benchmark</a></li><li class="menu-item menu-item-level-3" data-reactid="140"><a href="/en-us/docs/nacos2-config-benchmark.html" target="_self" data-reactid="141">Nacos2.0 Config Benchmark</a></li><li class="menu-item menu-item-level-3" data-reactid="142"><a href="/en-us/docs/nacos-naming-benchmark.html" target="_self" data-reactid="143">Nacos Naming Benchmark</a></li><li class="menu-item menu-item-level-3" data-reactid="144"><a href="/en-us/docs/nacos2-naming-benchmark.html" target="_self" data-reactid="145">Nacos2.0 Naming Benchmark</a></li><li class="menu-item menu-item-level-3" data-reactid="146"><a href="/en-us/docs/nacos-sync-use.html" target="_self" data-reactid="147">Data Migration to Nacos</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="148"><span data-reactid="149"><!-- react-text: 150 -->Nacos 2.0<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="151"/></span><ul data-reactid="152"><li class="menu-item menu-item-level-3" data-reactid="153"><a href="/en-us/docs/2.0.0-compatibility.html" target="_self" data-reactid="154">Compatibility&amp;Usage</a></li><li class="menu-item menu-item-level-3" data-reactid="155"><a href="/en-us/docs/2.0.0-upgrading.html" target="_self" data-reactid="156">Upgrading</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="157"><span data-reactid="158"><!-- react-text: 159 -->Contributor Guide<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="160"/></span><ul data-reactid="161"><li class="menu-item menu-item-level-3" data-reactid="162"><a href="/en-us/docs/contributing.html" target="_self" data-reactid="163">Contribute to Nacos</a></li><li class="menu-item menu-item-level-3" data-reactid="164"><a href="/en-us/docs/contributing-flow.html" target="_self" data-reactid="165">Contributing Flow</a></li><li class="menu-item menu-item-level-3" data-reactid="166"><a href="/en-us/docs/pull-request.html" target="_self" data-reactid="167">Pull Request Template</a></li><li class="menu-item menu-item-level-3" data-reactid="168"><a href="/en-us/docs/how-to-reporting-bugs.html" target="_self" data-reactid="169">How to report bugs</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="170"><span data-reactid="171"><!-- react-text: 172 -->Community<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="173"/></span><ul data-reactid="174"><li class="menu-item menu-item-level-3" data-reactid="175"><a href="/en-us/docs/community.html" target="_self" data-reactid="176">Community</a></li><li class="menu-item menu-item-level-3" data-reactid="177"><a href="/en-us/docs/nacos-dev.html" target="_self" data-reactid="178">Develop Team</a></li></ul></li></ul></li></ul></div><div class="doc-content markdown-body" data-reactid="179"><h1>Kubernetes Nacos</h1>
<p>This project contains a Nacos Docker image meant to facilitate the deployment of <a href="https://nacos.io">Nacos</a> on <a href="https://kubernetes.io/">Kubernetes</a> via StatefulSets.</p>
<h1>Quick Start</h1>
<ul>
<li><strong>Clone Project</strong></li>
</ul>
<pre><code class="language-shell">git clone https://github.com/nacos-group/nacos-k8s.git
</code></pre>
<ul>
<li><strong>Simple Start</strong></li>
</ul>
<blockquote>
<p>If you want to start Nacos without NFS, but <strong>emptyDirs will possibly result in a loss of data</strong>. as follows:</p>
</blockquote>
<pre><code class="language-shell">cd nacos-k8s
chmod +x quick-startup.sh
./quick-startup.sh
</code></pre>
<ul>
<li>
<p><strong>Testing</strong></p>
<ul>
<li><strong>Service registration</strong></li>
</ul>
<pre><code class="language-powershell">curl -X PUT <span class="hljs-string">'http://cluster-ip:8848/nacos/v1/ns/instance?serviceName=nacos.naming.serviceName&amp;ip=20.18.7.10&amp;port=8080'</span>
</code></pre>
<ul>
<li><strong>Service discovery</strong></li>
</ul>
<pre><code class="language-powershell">curl -X GET <span class="hljs-string">'http://cluster-ip:8848/nacos/v1/ns/instance/list?serviceName=nacos.naming.serviceName'</span>
</code></pre>
<ul>
<li><strong>Publish config</strong></li>
</ul>
<pre><code class="language-powershell">curl -X POST <span class="hljs-string">"http://cluster-ip:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test&amp;content=helloWorld"</span>
</code></pre>
<ul>
<li><strong>Get config</strong></li>
</ul>
<pre><code class="language-powershell">curl -X GET <span class="hljs-string">"http://cluster-ip:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test"</span>
</code></pre>
</li>
</ul>
<h1>Advanced</h1>
<blockquote>
<p>In advanced use, the cluster is automatically scaled and data is persisted, but <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistentvolumeclaims">PersistentVolumeClaims</a> must be deployed. In this example, NFS is used.</p>
</blockquote>
<h2>Deploy NFS</h2>
<ul>
<li>Create Role</li>
</ul>
<pre><code class="language-shell">kubectl create -f deploy/nfs/rbac.yaml
</code></pre>
<blockquote>
<p>If your K8S namespace is not default, execute the following script before creating RBAC</p>
</blockquote>
<pre><code class="language-shell"><span class="hljs-meta">#</span><span class="bash"> Set the subject of the RBAC objects to the current namespace <span class="hljs-built_in">where</span> the provisioner is being deployed</span>
<span class="hljs-meta">$</span><span class="bash"> NS=$(kubectl config get-contexts|grep -e <span class="hljs-string">"^\*"</span> |awk <span class="hljs-string">'{print $5}'</span>)</span>
<span class="hljs-meta">$</span><span class="bash"> NAMESPACE=<span class="hljs-variable">${NS:-default}</span></span>
<span class="hljs-meta">$</span><span class="bash"> sed -i<span class="hljs-string">''</span> <span class="hljs-string">"s/namespace:.*/namespace: <span class="hljs-variable">$NAMESPACE</span>/g"</span> ./deploy/nfs/rbac.yaml</span>

</code></pre>
<ul>
<li>Create <code>ServiceAccount</code> And deploy <code>NFS-Client Provisioner</code></li>
</ul>
<pre><code class="language-shell">kubectl create -f deploy/nfs/deployment.yaml
</code></pre>
<ul>
<li>Create NFS StorageClass</li>
</ul>
<pre><code class="language-shell">kubectl create -f deploy/nfs/class.yaml
</code></pre>
<ul>
<li>Verify that NFS is working</li>
</ul>
<pre><code class="language-shell">kubectl get pod -l app=nfs-client-provisioner
</code></pre>
<h2>Deploy database</h2>
<ul>
<li>Deploy master</li>
</ul>
<pre><code class="language-shell">
cd nacos-k8s

kubectl create -f deploy/mysql/mysql-master-nfs.yaml
</code></pre>
<ul>
<li>Deploy slave</li>
</ul>
<pre><code class="language-shell">
cd nacos-k8s 

kubectl create -f deploy/mysql/mysql-slave-nfs.yaml
</code></pre>
<ul>
<li>Verify that Database is working</li>
</ul>
<pre><code class="language-shell"><span class="hljs-meta">#</span><span class="bash"> master</span>
kubectl get pod 
NAME                         READY   STATUS    RESTARTS   AGE
mysql-master-gf2vd                        1/1     Running   0          111m
<span class="hljs-meta">
#</span><span class="bash"> slave</span>
kubectl get pod 
mysql-slave-kf9cb                         1/1     Running   0          110m
</code></pre>
<h2>Deploy Nacos</h2>
<ul>
<li>Modify  <strong>deploy/nacos/nacos-pvc-nfs.yaml</strong></li>
</ul>
<pre><code class="language-yaml"><span class="hljs-attr">data:</span>
  <span class="hljs-string">mysql.master.db.name:</span> <span class="hljs-string">"db name"</span>
  <span class="hljs-string">mysql.master.port:</span> <span class="hljs-string">"master db port"</span>
  <span class="hljs-string">mysql.slave.port:</span> <span class="hljs-string">"slave db port"</span>
  <span class="hljs-string">mysql.master.user:</span> <span class="hljs-string">"master db username"</span>
  <span class="hljs-string">mysql.master.password:</span> <span class="hljs-string">"master db password"</span>
</code></pre>
<ul>
<li>Create Nacos</li>
</ul>
<pre><code class="language-shell">kubectl create -f nacos-k8s/deploy/nacos/nacos-pvc-nfs.yaml
</code></pre>
<ul>
<li>Verify that Nacos is working</li>
</ul>
<pre><code class="language-shell">kubectl get pod -l app=nacos


NAME      READY   STATUS    RESTARTS   AGE
nacos-0   1/1     Running   0          19h
nacos-1   1/1     Running   0          19h
nacos-2   1/1     Running   0          19h
</code></pre>
<h2>Scale Testing</h2>
<ul>
<li>Use <a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands/#exec"><code>kubectl exec</code></a> to get the cluster config of the Pods in the <code>nacos</code> StatefulSet.</li>
</ul>
<pre><code class="language-powershell"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>; <span class="hljs-keyword">do</span> echo nacos-<span class="hljs-variable">$i</span>; kubectl exec nacos-<span class="hljs-variable">$i</span> cat conf/cluster.conf; done
</code></pre>
<p>The StatefulSet controller provides each Pod with a unique hostname based on its ordinal index. The hostnames take the form of <code>&lt;statefulset name&gt;-&lt;ordinal index&gt;</code>. Because the <code>replicas</code> field of the <code>nacos</code> StatefulSet is set to <code>2</code>, In the cluster file only two nacos address</p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/gif/338441/1562846123635-e361d2b5-4bbe-4347-acad-8f11f75e6d38.gif" alt="k8s"></p>
<ul>
<li>Use kubectl to scale StatefulSets</li>
</ul>
<pre><code class="language-bash">kubectl scale sts nacos --replicas=3
</code></pre>
<p><img src="https://cdn.nlark.com/yuque/0/2019/gif/338441/1562846139093-7a79b709-9afa-448a-b7d6-f57571d3a902.gif" alt="scale"></p>
<ul>
<li>Use <a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands/#exec"><code>kubectl exec</code></a> to get the cluster config of the Pods in the <code>nacos</code> StatefulSet after scale StatefulSets</li>
</ul>
<pre><code class="language-bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> 0 1 2; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> nacos-<span class="hljs-variable">$i</span>; kubectl <span class="hljs-built_in">exec</span> nacos-<span class="hljs-variable">$i</span> cat conf/cluster.conf; <span class="hljs-keyword">done</span>
</code></pre>
<p><img src="https://cdn.nlark.com/yuque/0/2019/gif/338441/1562846177553-c1c7f379-1b41-4026-9f0b-23e15dde02a8.gif" alt="get_cluster_after"></p>
<ul>
<li>Use <a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands/#exec"><code>kubectl exec</code></a> to get the <strong>state</strong> of the Pods in the <code>nacos</code> StatefulSet after scale StatefulSets</li>
</ul>
<pre><code class="language-bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> 0 1 2; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> nacos-<span class="hljs-variable">$i</span>; kubectl <span class="hljs-built_in">exec</span> nacos-<span class="hljs-variable">$i</span> curl -X GET <span class="hljs-string">"http://localhost:8848/nacos/v1/ns/raft/state"</span>; <span class="hljs-keyword">done</span>
</code></pre>
<p>You can find that the new node has joined the cluster</p>
<h1>Prerequisites</h1>
<ul>
<li>Kubernetes Node configuration(for reference only)</li>
</ul>
<table>
<thead>
<tr>
<th>Network IP</th>
<th>Hostname</th>
<th>Configuration</th>
</tr>
</thead>
<tbody>
<tr>
<td>172.17.79.3</td>
<td>k8s-master</td>
<td>CentOS Linux release 7.4.1708 (Core) Single-core processor Mem 4G Cloud disk 40G</td>
</tr>
<tr>
<td>172.17.79.4</td>
<td>node01</td>
<td>CentOS Linux release 7.4.1708 (Core) Single-core processor Mem 4G Cloud disk 40G</td>
</tr>
<tr>
<td>172.17.79.5</td>
<td>node02</td>
<td>CentOS Linux release 7.4.1708 (Core) Single-core processor Mem 4G Cloud disk 40G</td>
</tr>
</tbody>
</table>
<ul>
<li>Kubernetes version：<strong>1.12.2+</strong></li>
<li>NFS version：<strong>4.1+</strong></li>
</ul>
<h1>Limitations</h1>
<ul>
<li>Persistent Volumes must be used. emptyDirs will possibly result in a loss of data</li>
</ul>
<h1>Project directory</h1>
<table>
<thead>
<tr>
<th>Directory Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>plugin</code></td>
<td>Help Nacos cluster achieve automatic scaling in K8s</td>
</tr>
<tr>
<td><code>deploy</code></td>
<td>Deploy the required files</td>
</tr>
</tbody>
</table>
<h1>Configuration properties</h1>
<ul>
<li>nacos-pvc-nfs.yaml or nacos-quick-start.yaml</li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mysql.master.db.name</code></td>
<td>Y</td>
<td>Master database name</td>
</tr>
<tr>
<td><code>mysql.master.port</code></td>
<td>N</td>
<td>Master database port</td>
</tr>
<tr>
<td><code>mysql.slave.port</code></td>
<td>N</td>
<td>Slave database port</td>
</tr>
<tr>
<td><code>mysql.master.user</code></td>
<td>Y</td>
<td>Master database username</td>
</tr>
<tr>
<td><code>mysql.master.password</code></td>
<td>Y</td>
<td>Master database password</td>
</tr>
<tr>
<td><code>NACOS_REPLICAS</code></td>
<td>Y</td>
<td>The number of clusters must be consistent with the value of the replicas attribute</td>
</tr>
<tr>
<td><code>NACOS_SERVER_PORT</code></td>
<td>N</td>
<td>Nacos port,default:8848</td>
</tr>
<tr>
<td><code>PREFER_HOST_MODE</code></td>
<td>Y</td>
<td>Enable Nacos cluster node domain name support</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>nfs</strong> deployment.yaml</li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>NFS_SERVER</code></td>
<td>Y</td>
<td>NFS server address</td>
</tr>
<tr>
<td><code>NFS_PATH</code></td>
<td>Y</td>
<td>NFS server shared directory</td>
</tr>
<tr>
<td><code>server</code></td>
<td>Y</td>
<td>NFS server address</td>
</tr>
<tr>
<td><code>path</code></td>
<td>Y</td>
<td>NFS server shared directory</td>
</tr>
</tbody>
</table>
<ul>
<li>mysql yaml</li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>MYSQL_ROOT_PASSWORD</code></td>
<td>N</td>
<td>Root password</td>
</tr>
<tr>
<td><code>MYSQL_DATABASE</code></td>
<td>Y</td>
<td>Database Name</td>
</tr>
<tr>
<td><code>MYSQL_USER</code></td>
<td>Y</td>
<td>Database Username</td>
</tr>
<tr>
<td><code>MYSQL_PASSWORD</code></td>
<td>Y</td>
<td>Database Password</td>
</tr>
<tr>
<td><code>MYSQL_REPLICATION_USER</code></td>
<td>Y</td>
<td>Master-slave replication username</td>
</tr>
<tr>
<td><code>MYSQL_REPLICATION_PASSWORD</code></td>
<td>Y</td>
<td>Master-slave replication password</td>
</tr>
<tr>
<td><code>Nfs:server</code></td>
<td>Y</td>
<td>NFS server address</td>
</tr>
<tr>
<td><code>Nfs:path</code></td>
<td>Y</td>
<td>NFS server shared path</td>
</tr>
</tbody>
</table>
</div></div></section><footer class="footer-container" data-reactid="180"><div class="footer-body" data-reactid="181"><img src="/img/nacos_gray.png" data-reactid="182"/><div class="cols-container" data-reactid="183"><div class="col col-12" data-reactid="184"><h3 data-reactid="185">Vision</h3><p data-reactid="186">By providing an easy-to-use service infrastructure such as dynamic service discovery, service configuration, service sharing and management and etc., Nacos help users better construct, deliver and manage their own service platform, reuse and composite business service faster and deliver value of business innovation more quickly so as to win market for users in the era of cloud native and in all cloud environments, such as private, mixed, or public clouds.</p></div><div class="col col-6" data-reactid="187"><dl data-reactid="188"><dt data-reactid="189">Documentation</dt><dd data-reactid="190"><a href="/en-us/docs/what-is-nacos.html" target="_self" data-reactid="191">Overview</a></dd><dd data-reactid="192"><a href="/en-us/docs/quick-start.html" target="_self" data-reactid="193">Quick start</a></dd><dd data-reactid="194"><a href="/en-us/docs/contributing.html" target="_self" data-reactid="195">Developer guide</a></dd></dl></div><div class="col col-6" data-reactid="196"><dl data-reactid="197"><dt data-reactid="198">Resources</dt><dd data-reactid="199"><a href="/en-us/community/index.html" target="_self" data-reactid="200">Community</a></dd><dd data-reactid="201"><a href="https://cn.aliyun.com/product/aliware/mse?spm=nacos-website.topbar.0.0.0" target="_self" data-reactid="202">Cloud Service MSE</a></dd><dd data-reactid="203"><a href="https://www.aliyun.com/product/edas?source_type=nacos_pc_20181219" target="_self" data-reactid="204">Cloud Service EDAS</a></dd><dd data-reactid="205"><a href="https://www.aliyun.com/product/ahas?source_type=nacos_pc_20190225" target="_self" data-reactid="206">Cloud Service AHAS</a></dd></dl></div></div><div class="copyright" data-reactid="207"><span data-reactid="208">@ 2018 The Nacos Authors | An Alibaba Middleware (Aliware) Project</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js">
	</script>
	<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?e3a5cec56ef8619cf9d7c2abebd509e3";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
</body>
</html>