<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="Nacos,Spring" />
	<meta name="description" content="Nacos Spring" />
	<!-- 网页标签标题 -->
	<title>Nacos Spring</title>
	<link rel="shortcut icon" href="https://img.alicdn.com/tfs/TB1hgJpHAPoK1RjSZKbXXX1IXXa-64-64.png"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot="" data-reactid="1" data-react-checksum="2100048829"><header class="header-container header-container-normal" data-reactid="2"><div class="header-body" data-reactid="3"><a href="/en-us/index.html" data-reactid="4"><img class="logo" src="/img/nacos_colorful.png" data-reactid="5"/></a><div class="search search-normal" data-reactid="6"><span class="icon-search" data-reactid="7"></span></div><span class="language-switch language-switch-normal" data-reactid="8">中</span><div class="header-menu" data-reactid="9"><img class="header-menu-toggle" src="/img/menu_gray.png" data-reactid="10"/><ul data-reactid="11"><li class="menu-item menu-item-normal" data-reactid="12"><span data-reactid="13"><a href="/en-us/index.html" data-reactid="14">HOME</a></span></li><li class="menu-item menu-item-normal menu-item-normal-active" data-reactid="15"><span data-reactid="16"><a href="/en-us/docs/quick-start.html" data-reactid="17">DOCS</a></span></li><li class="menu-item menu-item-normal" data-reactid="18"><div class="nav-container" data-reactid="19"><div class="word" data-reactid="20"><a data-reactid="21">SOLUTIONS</a><img class="menu-img" src="https://img.alicdn.com/tfs/TB1esl_m.T1gK0jSZFrXXcNCXXa-200-200.png" data-reactid="22"/></div><ul class="sub-nav-container" style="width:290px;" data-reactid="23"><li data-reactid="24"><a href="https://cn.aliyun.com/product/aliware/mse?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="25">Microservice Solution</a></li><li data-reactid="26"><a href="https://cn.aliyun.com/product/aliware/sae?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="27">Microservice on Serverless Solution</a></li><li data-reactid="28"><a href="https://www.aliyun.com/product/edas?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="29">PaaS Solution</a></li><li data-reactid="30"><a href="https://www.aliyun.com/aliware/txc?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="31">Distributed transaction Solution</a></li><li data-reactid="32"><a href="https://www.aliyun.com/product/ahas?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="33">High-availability Solution</a></li><li data-reactid="34"><a href="https://www.aliyun.com/product/servicemesh?spm=nacos-website.topbar.0.0.0" target="_blank" data-reactid="35">Service mesh Solution</a></li></ul><!-- react-text: 36 --> <!-- /react-text --></div></li><li class="menu-item menu-item-normal" data-reactid="37"><span data-reactid="38"><a href="https://cn.aliyun.com/product/aliware/mse?spm=nacos-website.topbar.0.0.0" data-reactid="39">NACOS IN CLOUD</a><img class="menu-img" src="https://img.alicdn.com/tfs/TB1esl_m.T1gK0jSZFrXXcNCXXa-200-200.png" data-reactid="40"/></span></li><li class="menu-item menu-item-normal" data-reactid="41"><span data-reactid="42"><a href="https://developer.aliyun.com/topic/download?id=8230" data-reactid="43">E-BOOK</a><img class="menu-img" src="https://img.alicdn.com/tfs/TB1esl_m.T1gK0jSZFrXXcNCXXa-200-200.png" data-reactid="44"/></span></li><li class="menu-item menu-item-normal" data-reactid="45"><span data-reactid="46"><a href="/en-us/blog" data-reactid="47">BLOG</a></span></li><li class="menu-item menu-item-normal" data-reactid="48"><span data-reactid="49"><a href="/en-us/community" data-reactid="50">COMMUNITY</a></span></li><li class="menu-item menu-item-normal" data-reactid="51"><span data-reactid="52"><a href="http://console.nacos.io/nacos/index.html" data-reactid="53">DEMO-CONSOLE</a></span></li></ul></div></div></header><div class="bar" data-reactid="54"><div class="bar-body" data-reactid="55"><img src="/img/docs.png" class="front-img" data-reactid="56"/><div class="bar-title" data-reactid="57"><span data-reactid="58">Documentation</span><div class="bone bone-light" data-reactid="59"></div></div><img src="/img/docs.png" class="back-img" data-reactid="60"/></div></div><section class="content-section" data-reactid="61"><div class="content-body" data-reactid="62"><div class="sidemenu" data-reactid="63"><div class="sidemenu-toggle" data-reactid="64"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png" data-reactid="65"/></div><ul data-reactid="66"><li class="menu-item menu-item-level-1" data-reactid="67"><span data-reactid="68">Nacos </span><ul data-reactid="69"><li style="height:180px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="70"><span data-reactid="71"><!-- react-text: 72 -->What is Nacos<!-- /react-text --><img style="transform:rotate(0deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="73"/></span><ul data-reactid="74"><li class="menu-item menu-item-level-3" data-reactid="75"><a href="/en-us/docs/what-is-nacos.html" target="_self" data-reactid="76">What is Nacos</a></li><li class="menu-item menu-item-level-3" data-reactid="77"><a href="/en-us/docs/concepts.html" target="_self" data-reactid="78">Concepts</a></li><li class="menu-item menu-item-level-3" data-reactid="79"><a href="/en-us/docs/architecture.html" target="_self" data-reactid="80">Architecure</a></li><li class="menu-item menu-item-level-3" data-reactid="81"><a href="/en-us/docs/feature-list.html" target="_self" data-reactid="82">Feature list</a></li></ul></li><li style="height:324px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="83"><span data-reactid="84"><!-- react-text: 85 -->Quick Start<!-- /react-text --><img style="transform:rotate(0deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="86"/></span><ul data-reactid="87"><li class="menu-item menu-item-level-3" data-reactid="88"><a href="/en-us/docs/quick-start.html" target="_self" data-reactid="89">Nacos</a></li><li class="menu-item menu-item-level-3" data-reactid="90"><a href="/en-us/docs/quick-start-spring.html" target="_self" data-reactid="91">Nacos Spring</a></li><li class="menu-item menu-item-level-3" data-reactid="92"><a href="/en-us/docs/quick-start-spring-boot.html" target="_self" data-reactid="93">Nacos Spring Boot</a></li><li class="menu-item menu-item-level-3" data-reactid="94"><a href="/en-us/docs/quick-start-spring-cloud.html" target="_self" data-reactid="95">Nacos Spring Cloud</a></li><li class="menu-item menu-item-level-3" data-reactid="96"><a href="/en-us/docs/quick-start-docker.html" target="_self" data-reactid="97">Nacos Docker</a></li><li class="menu-item menu-item-level-3" data-reactid="98"><a href="/en-us/docs/use-nacos-with-dubbo.html" target="_self" data-reactid="99">Nacos with Dubbo</a></li><li class="menu-item menu-item-level-3" data-reactid="100"><a href="/en-us/docs/use-nacos-with-kubernetes.html" target="_self" data-reactid="101">Nacos with K8s</a></li><li class="menu-item menu-item-level-3" data-reactid="102"><a href="/en-us/docs/nacos-sync.html" target="_self" data-reactid="103">Nacos Sync</a></li></ul></li><li style="height:288px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="104"><span data-reactid="105"><!-- react-text: 106 -->User Guide<!-- /react-text --><img style="transform:rotate(0deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="107"/></span><ul data-reactid="108"><li class="menu-item menu-item-level-3" data-reactid="109"><a href="/en-us/docs/sdk.html" target="_self" data-reactid="110">Java SDK</a></li><li class="menu-item menu-item-level-3" data-reactid="111"><a href="/en-us/docs/other-language.html" target="_self" data-reactid="112">Other Language</a></li><li class="menu-item menu-item-level-3" data-reactid="113"><a href="/en-us/docs/open-api.html" target="_self" data-reactid="114">Open-API</a></li><li class="menu-item menu-item-level-3" data-reactid="115"><a href="/en-us/docs/nacos-spring.html" target="_self" data-reactid="116">Nacos Spring</a></li><li class="menu-item menu-item-level-3" data-reactid="117"><a href="/en-us/docs/system-configurations.html" target="_self" data-reactid="118">Nacos System Configurations</a></li><li class="menu-item menu-item-level-3" data-reactid="119"><a href="/en-us/docs/auth.html" target="_self" data-reactid="120">Authentication</a></li><li class="menu-item menu-item-level-3" data-reactid="121"><a href="/en-us/docs/faq.html" target="_self" data-reactid="122">FAQ</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="123"><span data-reactid="124"><!-- react-text: 125 -->Admin Guide<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="126"/></span><ul data-reactid="127"><li class="menu-item menu-item-level-3" data-reactid="128"><a href="/en-us/docs/deployment.html" target="_self" data-reactid="129">Deployment Guide</a></li><li class="menu-item menu-item-level-3" data-reactid="130"><a href="/en-us/docs/cluster-mode-quick-start.html" target="_self" data-reactid="131">Cluster Mode Deployment</a></li><li class="menu-item menu-item-level-3" data-reactid="132"><a href="/en-us/docs/management-api.html" target="_self" data-reactid="133">Management OpenAPI</a></li><li class="menu-item menu-item-level-3" data-reactid="134"><a href="/en-us/docs/console-guide.html" target="_self" data-reactid="135">Admin Console Guide</a></li><li class="menu-item menu-item-level-3" data-reactid="136"><a href="/en-us/docs/monitor-guide.html" target="_self" data-reactid="137">Nacos Monitor Guide</a></li><li class="menu-item menu-item-level-3" data-reactid="138"><a href="/en-us/docs/nacos-config-benchmark.html" target="_self" data-reactid="139">Nacos Config Benchmark</a></li><li class="menu-item menu-item-level-3" data-reactid="140"><a href="/en-us/docs/nacos2-config-benchmark.html" target="_self" data-reactid="141">Nacos2.0 Config Benchmark</a></li><li class="menu-item menu-item-level-3" data-reactid="142"><a href="/en-us/docs/nacos-naming-benchmark.html" target="_self" data-reactid="143">Nacos Naming Benchmark</a></li><li class="menu-item menu-item-level-3" data-reactid="144"><a href="/en-us/docs/nacos2-naming-benchmark.html" target="_self" data-reactid="145">Nacos2.0 Naming Benchmark</a></li><li class="menu-item menu-item-level-3" data-reactid="146"><a href="/en-us/docs/nacos-sync-use.html" target="_self" data-reactid="147">Data Migration to Nacos</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="148"><span data-reactid="149"><!-- react-text: 150 -->Nacos 2.0<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="151"/></span><ul data-reactid="152"><li class="menu-item menu-item-level-3" data-reactid="153"><a href="/en-us/docs/2.0.0-compatibility.html" target="_self" data-reactid="154">Compatibility&amp;Usage</a></li><li class="menu-item menu-item-level-3" data-reactid="155"><a href="/en-us/docs/2.0.0-upgrading.html" target="_self" data-reactid="156">Upgrading</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="157"><span data-reactid="158"><!-- react-text: 159 -->Contributor Guide<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="160"/></span><ul data-reactid="161"><li class="menu-item menu-item-level-3" data-reactid="162"><a href="/en-us/docs/contributing.html" target="_self" data-reactid="163">Contribute to Nacos</a></li><li class="menu-item menu-item-level-3" data-reactid="164"><a href="/en-us/docs/contributing-flow.html" target="_self" data-reactid="165">Contributing Flow</a></li><li class="menu-item menu-item-level-3" data-reactid="166"><a href="/en-us/docs/pull-request.html" target="_self" data-reactid="167">Pull Request Template</a></li><li class="menu-item menu-item-level-3" data-reactid="168"><a href="/en-us/docs/how-to-reporting-bugs.html" target="_self" data-reactid="169">How to report bugs</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="170"><span data-reactid="171"><!-- react-text: 172 -->Community<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="173"/></span><ul data-reactid="174"><li class="menu-item menu-item-level-3" data-reactid="175"><a href="/en-us/docs/community.html" target="_self" data-reactid="176">Community</a></li><li class="menu-item menu-item-level-3" data-reactid="177"><a href="/en-us/docs/nacos-dev.html" target="_self" data-reactid="178">Develop Team</a></li></ul></li></ul></li></ul></div><div class="doc-content markdown-body" data-reactid="179"><h1>Nacos Spring</h1>
<p>This section provides a detailed description of the key features of <a href="nacos-spring-context"><code>nacos-spring-context</code></a>:</p>
<ul>
<li>Annotation-Driven</li>
<li>Dependency Injection</li>
<li>Externalized Configuration</li>
<li>Event-Driven</li>
</ul>
<h2>1. Annotation-Driven</h2>
<h3>1.1. Enable Nacos</h3>
<p><code>@EnableNacos</code> is a modular-driven annotation that enables all features of Nacos Spring, including <strong>Service Discovery</strong> and <strong>Distributed Configuration</strong>. It equals to  <code>@EnableNacosDiscovery</code> and
<code>@EnableNacosConfig</code>, which can be configured separately and used in different scenarios.</p>
<h3>1.2. Configure Change Listener method</h3>
<p>Suppose there was a config in Nacos Server whose <code>dataId</code> is &quot;testDataId&quot; and <code>groupId</code> is default group(&quot;DEFAULT_GROUP&quot;). Now you would like to change its content by using the <code>ConfigService#publishConfig</code> method:</p>
<pre><code class="language-java"><span class="hljs-meta">@NacosInjected</span>
<span class="hljs-keyword">private</span> ConfigService configService;

<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testPublishConfig</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> NacosException </span>{
    configService.publishConfig(DATA_ID, DEFAULT_GROUP, <span class="hljs-string">"9527"</span>);
}
</code></pre>
<p>Then you would like to add a listener, which will be listening for the config changes. You can do this by adding a config change listener method into your Spring Beans:</p>
<pre><code class="language-java"><span class="hljs-meta">@NacosConfigListener</span>(dataId = DATA_ID)
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(String config)</span> </span>{
    assertEquals(<span class="hljs-string">"mercyblitz"</span>, config); <span class="hljs-comment">// asserts true</span>
}
</code></pre>
<p>The code below has the same effect:</p>
<pre><code class="language-java">configService.addListener(DATA_ID, DEFAULT_GROUP, <span class="hljs-keyword">new</span> AbstractListener() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">receiveConfigInfo</span><span class="hljs-params">(String config)</span> </span>{
        assertEquals(<span class="hljs-string">"9527"</span>, config); <span class="hljs-comment">// asserts true</span>
    }
});
</code></pre>
<p><strong>Note:</strong> <code>@NacosConfigListener</code> supports richer type conversions.</p>
<ul>
<li>See <a href="https://github.com/nacos-group/nacos-spring-project/blob/master/nacos-spring-samples/nacos-spring-webmvc-sample/src/main/java/com/alibaba/nacos/samples/spring/listener/SimpleNacosConfigListener.java">Simple Sample of <code>@NacosConfigListener</code></a></li>
</ul>
<h4>1.2.1. Type Conversion</h4>
<p>The type conversion of <code>@NacosConfigListener</code> includes both build-in and customized implementations. By default, build-in type conversion is based on Spring <code>DefaultFormattingConversionService</code>, which means it covers most of the general cases as well as the rich features of the higher Spring framework.</p>
<p>For example, the content &quot;9527&quot; in the preceding example can also be listened by a method with integer or the <code>Integer</code> argument:</p>
<pre><code class="language-java"><span class="hljs-meta">@NacosConfigListener</span>(dataId = DATA_ID)
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onInteger</span><span class="hljs-params">(Integer value)</span> </span>{
    assertEquals(Integer.valueOf(<span class="hljs-number">9527</span>), value); <span class="hljs-comment">// asserts true</span>
}

<span class="hljs-meta">@NacosConfigListener</span>(dataId = DATA_ID)
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onInt</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>{
    assertEquals(<span class="hljs-number">9527</span>, value); <span class="hljs-comment">// asserts true</span>
}
</code></pre>
<p>Of course, <a href="nacos-spring-context"><code>nacos-spring-context</code></a> provides elastic extension for developers. If you define a named <code>nacosConfigConversionService</code> Spring Bean whose type is <code>ConversionService</code> , the <code>DefaultFormattingConversionService</code> will be ignored. In addition, you can customize the implementation of  the <code>NacosConfigConverter</code> interface to specify a listener method for type conversion:</p>
<pre><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserNacosConfigConverter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">NacosConfigConverter</span>&lt;<span class="hljs-title">User</span>&gt; </span>{

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">canConvert</span><span class="hljs-params">(Class&lt;User&gt; targetType)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">convert</span><span class="hljs-params">(String source)</span> </span>{
        <span class="hljs-keyword">return</span> JSON.parseObject(source, User.class);
    }
}
</code></pre>
<p>The <code>UserNacosConfigConverter</code> class binds the <code>@NacosConfigListener.converter()</code> attribute:</p>
<pre><code class="language-java"><span class="hljs-meta">@NacosInjected</span>
<span class="hljs-keyword">private</span> ConfigService configService;

<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testPublishUser</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> NacosException </span>{
    configService.publishConfig(<span class="hljs-string">"user"</span>, DEFAULT_GROUP, <span class="hljs-string">"{\"id\":1,\"name\":\"mercyblitz\"}"</span>);
}

<span class="hljs-meta">@NacosConfigListener</span>(dataId = <span class="hljs-string">"user"</span>, converter = UserNacosConfigConverter.class)
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onUser</span><span class="hljs-params">(User user)</span> </span>{
    assertEquals(Long.valueOf(<span class="hljs-number">1L</span>), user.getId()); 
    assertEquals(<span class="hljs-string">"mercyblitz"</span>, user.getName());
}
</code></pre>
<ul>
<li>See <a href="https://github.com/nacos-group/nacos-spring-project/blob/master/nacos-spring-samples/nacos-spring-webmvc-sample/src/main/java/com/alibaba/nacos/samples/spring/listener/PojoNacosConfigListener.java">Type Conversion Sample of <code>@NacosConfigListener</code></a></li>
</ul>
<h4>1.2.2. Timeout of Execution</h4>
<p>As it might cost some time to run customized <code>NacosConfigConverter</code>, you can set  max execution time in the <code>@NacosConfigListener.timeout()</code> attribute to prevent it from blocking other listeners:</p>
<pre><code class="language-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listeners</span> </span>{

    <span class="hljs-keyword">private</span> Integer integerValue;

    <span class="hljs-keyword">private</span> Double doubleValue;

    <span class="hljs-meta">@NacosConfigListener</span>(dataId = DATA_ID, timeout = <span class="hljs-number">50</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onInteger</span><span class="hljs-params">(Integer value)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        Thread.sleep(<span class="hljs-number">100</span>); <span class="hljs-comment">// timeout of execution</span>
        <span class="hljs-keyword">this</span>.integerValue = value;
    }

    <span class="hljs-meta">@NacosConfigListener</span>(dataId = DATA_ID, timeout = <span class="hljs-number">200</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDouble</span><span class="hljs-params">(Double value)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        Thread.sleep(<span class="hljs-number">100</span>); <span class="hljs-comment">// normal execution</span>
        <span class="hljs-keyword">this</span>.doubleValue = value;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getIntegerValue</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> integerValue;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> Double <span class="hljs-title">getDoubleValue</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> doubleValue;
    }
}
</code></pre>
<p>The <code>integerValue</code> of <code>Listeners</code> Bean is always <code>null</code> and will not be changed. Therefore, those asserts will be <code>true</code>:</p>
<pre><code class="language-java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> Listeners listeners;

<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testPublishConfig</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> NacosException </span>{
    configService.publishConfig(DATA_ID, DEFAULT_GROUP, <span class="hljs-string">"9527"</span>);
    assertNull(listeners.getIntegerValue()); <span class="hljs-comment">// asserts true</span>
    assertEquals(Double.valueOf(<span class="hljs-number">9527</span>), listeners.getDoubleValue());   <span class="hljs-comment">// asserts true</span>
}
</code></pre>
<ul>
<li>See <a href="https://github.com/nacos-group/nacos-spring-project/blob/master/nacos-spring-samples/nacos-spring-webmvc-sample/src/main/java/com/alibaba/nacos/samples/spring/listener/TimeoutNacosConfigListener.java">Timeout Sample of <code>@NacosConfigListener</code></a></li>
</ul>
<h3>1.3. Global and Special Nacos Properties</h3>
<p>The <code>globalProperties</code> is a required attribute in any <code>@EnableNacos</code>, <code>@EnableNacosDiscovery</code> or <code>@EnableNacosConfig</code>, and its type is <code>@NacosProperties</code>. <code>globalProperties</code> initializes &quot;<strong>Global Nacos Properties</strong>&quot; that will be used by other annotations
and components, e,g <code>@NacosInjected</code>. In other words, <strong>Global Nacos Properties</strong>&quot; defines the global and default properties. It is set with the lowest priority and can be overridden if needed. The precedence of overiding rules is shown in the following table:</p>
<table>
<thead>
<tr>
<th>Precedence Order</th>
<th>Nacos Annotation</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><code>*.properties()</code></td>
<td>N</td>
</tr>
<tr>
<td>2</td>
<td><code>@EnableNacosConfig.globalProperties()</code> or <code>@EnableNacosDiscovery.globalProperties()</code></td>
<td>Y</td>
</tr>
<tr>
<td>3</td>
<td><code>@EnableNacos.globalProperties()</code></td>
<td>Y</td>
</tr>
</tbody>
</table>
<p><code>*.properties()</code> defines special Nacos properties which come from one of the following:</p>
<ul>
<li><code>@NacosInjected.properties()</code></li>
<li><code>@NacosConfigListener.properties()</code></li>
<li><code>@NacosPropertySource.properties()</code></li>
<li><code>@NacosConfigurationProperties.properties()</code></li>
</ul>
<p>Special Nacos properties are also configured by <code>@NacosProperties</code>. However, they are optional and are used to override Global Nacos Properties in special scenarios. If not defined, the Nacos Properties will
try to retrieve properities from <code>@EnableNacosConfig.globalProperties()</code> or <code>@EnableNacosDiscovery.globalProperties()</code>, or
<code>@EnableNacos.globalProperties()</code>.</p>
<h3>1.4. <code>@NacosProperties</code></h3>
<p><code>@NacosProperties</code> is a uniform annotation for global and special Nacos properties. It serves as a mediator between Java <code>Properties</code> and <code>NacosFactory</code> class.   <code>NacosFactory</code> is responsible for creating <code>ConfigService</code> or <code>NamingService</code> instances.</p>
<p>The attributes of <code>@NacosProperties</code> completely support placeholders whose source is all kinds of <code>PropertySource</code> in Spring <code>Environment</code> abstraction, typically Java System <code>Properties</code> and OS environment variables. The prefix of all placeholders are <code>nacos.</code>.  The mapping between the attributes of <code>@NacosProperties</code> and Nacos properties are shown below:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Property</th>
<th>Placeholder</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>endpoint()</code></td>
<td><code>endpoint</code></td>
<td><code>${nacos.endpoint:}</code></td>
<td></td>
<td>N</td>
</tr>
<tr>
<td><code>namespace()</code></td>
<td><code>namespace</code></td>
<td><code>${nacos.namespace:}</code></td>
<td></td>
<td>N</td>
</tr>
<tr>
<td><code>accessKey()</code></td>
<td><code>access-key</code></td>
<td><code>${nacos.access-key:}</code></td>
<td></td>
<td>N</td>
</tr>
<tr>
<td><code>secretKey()</code></td>
<td><code>secret-key</code></td>
<td><code>${nacos.secret-key:}</code></td>
<td></td>
<td>N</td>
</tr>
<tr>
<td><code>serverAddr()</code></td>
<td><code>server-addr</code></td>
<td><code>${nacos.server-addr:}</code></td>
<td></td>
<td>Y</td>
</tr>
<tr>
<td><code>contextPath()</code></td>
<td><code>context-path</code></td>
<td><code>${nacos.context-path:}</code></td>
<td></td>
<td>N</td>
</tr>
<tr>
<td><code>clusterName()</code></td>
<td><code>cluster-name</code></td>
<td><code>${nacos.cluster-name:}</code></td>
<td></td>
<td>N</td>
</tr>
<tr>
<td><code>encode()</code></td>
<td><code>encode</code></td>
<td><code>${nacos.encode:UTF-8}</code></td>
<td></td>
<td>N</td>
</tr>
</tbody>
</table>
<p>Note that there are some differences in the placeholders of <code>globalProperties()</code> between <code>@EnableNacosDiscovery</code> and <code>@EnableNacosConfig</code>:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th><code>@EnableNacosDiscovery</code>'s Placeholder</th>
<th><code>@EnableNacosConfig</code>'s Placeholder</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>endpoint()</code></td>
<td><code>${nacos.discovery.endpoint:${nacos.endpoint:}}</code></td>
<td><code>${nacos.config.endpoint:${nacos.endpoint:}}</code></td>
</tr>
<tr>
<td><code>namespace()</code></td>
<td><code>${nacos.discovery.namespace:${nacos.namespace:}}</code></td>
<td><code>${nacos.config.namespace:${nacos.namespace:}}</code></td>
</tr>
<tr>
<td><code>accessKey()</code></td>
<td><code>${nacos.discovery.access-key:${nacos.access-key:}}</code></td>
<td><code>${nacos.config.access-key:${nacos.access-key:}}</code></td>
</tr>
<tr>
<td><code>secretKey()</code></td>
<td><code>${nacos.discovery.secret-key:${nacos.secret-key:}}</code></td>
<td><code>${nacos.config.secret-key:${nacos.secret-key:}}</code></td>
</tr>
<tr>
<td><code>serverAddr()</code></td>
<td><code>${nacos.discovery.server-addr:${nacos.server-addr:}}</code></td>
<td><code>${nacos.config.server-addr:${nacos.server-addr:}}</code></td>
</tr>
<tr>
<td><code>contextPath()</code></td>
<td><code>${nacos.discovery.context-path:${nacos.context-path:}}</code></td>
<td><code>${nacos.config.context-path:${nacos.context-path:}}</code></td>
</tr>
<tr>
<td><code>clusterName()</code></td>
<td><code>${nacos.discovery.cluster-name:${nacos.cluster-name:}}</code></td>
<td><code>${nacos.config.cluster-name:${nacos.cluster-name:}}</code></td>
</tr>
<tr>
<td><code>encode()</code></td>
<td><code>${nacos.discovery.encode:${nacos.encode:UTF-8}}</code></td>
<td><code>${nacos.config.encode:${nacos.encode:UTF-8}}</code></td>
</tr>
</tbody>
</table>
<p>These placeholders of <code>@EnableNacosDiscovery</code> and <code>@EnableNacosConfig</code> are designed to isolate different Nacos servers, and are unnecessary in most scenarios.  By default, general placeholders will be reused.</p>
<h2>2. Dependency Injection</h2>
<p><code>@NacosInjected</code> is a core annotation which is used to inject <code>ConfigService</code> or <code>NamingService</code> instance in your Spring Beans and make these instances <strong>cacheable</strong>. This means the instances will be the same if their <code>@NacosProperties</code> are equal, regargless of whether the properties come from global or special Nacos properties:</p>
<pre><code class="language-java"><span class="hljs-meta">@NacosInjected</span>
<span class="hljs-keyword">private</span> ConfigService configService;

<span class="hljs-meta">@NacosInjected</span>(properties = <span class="hljs-meta">@NacosProperties</span>(encode = <span class="hljs-string">"UTF-8"</span>))
<span class="hljs-keyword">private</span> ConfigService configService2;

<span class="hljs-meta">@NacosInjected</span>(properties = <span class="hljs-meta">@NacosProperties</span>(encode = <span class="hljs-string">"GBK"</span>))
<span class="hljs-keyword">private</span> ConfigService configService3;

<span class="hljs-meta">@NacosInjected</span>
<span class="hljs-keyword">private</span> NamingService namingService;

<span class="hljs-meta">@NacosInjected</span>(properties = <span class="hljs-meta">@NacosProperties</span>(encode = <span class="hljs-string">"UTF-8"</span>))
<span class="hljs-keyword">private</span> NamingService namingService2;

<span class="hljs-meta">@NacosInjected</span>(properties = <span class="hljs-meta">@NacosProperties</span>(encode = <span class="hljs-string">"GBK"</span>))
<span class="hljs-keyword">private</span> NamingService namingService3;

<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testInjection</span><span class="hljs-params">()</span> </span>{

    Assert.assertEquals(configService, configService2);
    Assert.assertNotEquals(configService2, configService3);

    Assert.assertEquals(namingService, namingService2);
    Assert.assertNotEquals(namingService2, namingService3);
}
</code></pre>
<p>The property <code>configService</code> uses <code>@EnableNacos#globalProperties()</code> or <code>@EnableNacosConfig#globalProperties()</code>, and because the default value of the <code>encode</code> attribute is &quot;UTF-8&quot;, therefore the <code>configService</code> instance and the <code>configService2</code> instance which is annotated by <code>@NacosProperties(encode = &quot;UTF-8&quot;)</code> are the same. The same is true for <code>namingService</code> and <code>namingService2</code>.</p>
<p>More importantly, unlike the <code>ConfigService</code> instances created by the <code>NacosFactory.createConfigService()</code> method, the <code>ConfigService</code> instances created by the <code>@NacosInjected</code> annotation support Nacos Spring events. For instance, there will be an <code>NacosConfigPublishedEvent</code>  after an enhanced <code>ConfigService</code> invokes the <code>publishConfig()</code> method. Refer to the <a href="#eventlistener-driven">Event/Listener Driven</a> section for more details.</p>
<ul>
<li>See <a href="https://github.com/nacos-group/nacos-spring-project/blob/master/nacos-spring-samples/nacos-spring-webmvc-sample/src/main/java/com/alibaba/nacos/samples/spring/NacosConfiguration.java">Dependency Injection Sample</a></li>
</ul>
<h2>3. Externalized Configuration</h2>
<p>Externalized configuration is a concept introduced by Spring Boot, which allows applications to receive external property sources to control runtime behavior. Nacos Server runs an isolation process outside the application to maintain the application configurations. <a href="nacos-spring-context"><code>nacos-spring-context</code></a> provides properties features including object binding, dynamic configuration(auto-refreshed) and so on, and dependence on Spring Boot or Spring Cloud framework is required.</p>
<p>Here is a simple comparison between  <a href="nacos-spring-context"><code>nacos-spring-context</code></a> and Spring stack:</p>
<table>
<thead>
<tr>
<th>Spring Stack</th>
<th>Nacos Spring</th>
<th>Highlight</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@Value</code></td>
<td><code>@NacosValue</code></td>
<td>auto-refreshed</td>
</tr>
<tr>
<td><code>@ConfigurationProperties</code></td>
<td><code>@NacosConfigurationProperties</code></td>
<td>auto-refreshed,<code>@NacosProperty</code>,<code>@NacosIgnore</code></td>
</tr>
<tr>
<td><code>@PropertySource</code></td>
<td><code>@NacosPropertySource</code></td>
<td>auto-refreshed, precedence order control</td>
</tr>
<tr>
<td><code>@PropertySources</code></td>
<td><code>@NacosPropertySources</code></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>See <a href="https://github.com/nacos-group/nacos-spring-project/blob/master/nacos-spring-samples/nacos-spring-webmvc-sample/src/main/java/com/alibaba/nacos/samples/spring/properties/NacosConfigurationPropertiesConfiguration.java">Auto-Refreshed Sample of <code>@NacosConfigurationProperties</code></a></p>
</li>
<li>
<p>See <a href="https://github.com/nacos-group/nacos-spring-project/blob/master/nacos-spring-samples/nacos-spring-webmvc-sample/src/main/java/com/alibaba/nacos/samples/spring/env/NacosPropertySourceConfiguration.java">Sample of <code>@NacosPropertySources</code> and <code>@NacosPropertySource</code></a></p>
</li>
</ul>
<h2>4. Event/Listener Driven</h2>
<p>Nacos Event/Listener Driven is based on the standard Spring Event/Listener mechanism. The <code>ApplicationEvent</code> of Spring is an abstract super class for all Nacos Spring events:</p>
<table>
<thead>
<tr>
<th>Nacos Spring Event</th>
<th>Trigger</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>NacosConfigPublishedEvent</code></td>
<td>After <code>ConfigService.publishConfig()</code></td>
</tr>
<tr>
<td><code>NacosConfigReceivedEvent</code></td>
<td>After<code>Listener.receiveConfigInfo()</code></td>
</tr>
<tr>
<td><code>NacosConfigRemovedEvent</code></td>
<td>After <code>configService.removeConfig()</code></td>
</tr>
<tr>
<td><code>NacosConfigTimeoutEvent</code></td>
<td><code>ConfigService.getConfig()</code> on timeout</td>
</tr>
<tr>
<td><code>NacosConfigListenerRegisteredEvent</code></td>
<td>After <code>ConfigService.addListner()</code> or <code>ConfigService.removeListener()</code></td>
</tr>
<tr>
<td><code>NacosConfigurationPropertiesBeanBoundEvent</code></td>
<td>After <code>@NacosConfigurationProperties</code> binding</td>
</tr>
<tr>
<td><code>NacosConfigMetadataEvent</code></td>
<td>After Nacos Config operations</td>
</tr>
</tbody>
</table>
<ul>
<li>See <a href="https://github.com/nacos-group/nacos-spring-project/blob/master/nacos-spring-samples/nacos-spring-webmvc-sample/src/main/java/com/alibaba/nacos/samples/spring/event/NacosEventListenerConfiguration.java">Event/Listener Sample</a></li>
</ul>
<h2>Related Projects</h2>
<ul>
<li><a href="https://github.com/alibaba/nacos">Nacos</a></li>
<li><a href="https://github.com/nacos-group/nacos-spring-project">Nacos Spring</a></li>
<li><a href="https://github.com/nacos-group/nacos-spring-boot-project">Nacos Spring Boot</a></li>
<li><a href="https://github.com/spring-cloud-incubator/spring-cloud-alibaba">Spring Cloud Alibaba</a></li>
</ul>
</div></div></section><footer class="footer-container" data-reactid="180"><div class="footer-body" data-reactid="181"><img src="/img/nacos_gray.png" data-reactid="182"/><div class="cols-container" data-reactid="183"><div class="col col-12" data-reactid="184"><h3 data-reactid="185">Vision</h3><p data-reactid="186">By providing an easy-to-use service infrastructure such as dynamic service discovery, service configuration, service sharing and management and etc., Nacos help users better construct, deliver and manage their own service platform, reuse and composite business service faster and deliver value of business innovation more quickly so as to win market for users in the era of cloud native and in all cloud environments, such as private, mixed, or public clouds.</p></div><div class="col col-6" data-reactid="187"><dl data-reactid="188"><dt data-reactid="189">Documentation</dt><dd data-reactid="190"><a href="/en-us/docs/what-is-nacos.html" target="_self" data-reactid="191">Overview</a></dd><dd data-reactid="192"><a href="/en-us/docs/quick-start.html" target="_self" data-reactid="193">Quick start</a></dd><dd data-reactid="194"><a href="/en-us/docs/contributing.html" target="_self" data-reactid="195">Developer guide</a></dd></dl></div><div class="col col-6" data-reactid="196"><dl data-reactid="197"><dt data-reactid="198">Resources</dt><dd data-reactid="199"><a href="/en-us/community/index.html" target="_self" data-reactid="200">Community</a></dd><dd data-reactid="201"><a href="https://cn.aliyun.com/product/aliware/mse?spm=nacos-website.topbar.0.0.0" target="_self" data-reactid="202">Cloud Service MSE</a></dd><dd data-reactid="203"><a href="https://www.aliyun.com/product/edas?source_type=nacos_pc_20181219" target="_self" data-reactid="204">Cloud Service EDAS</a></dd><dd data-reactid="205"><a href="https://www.aliyun.com/product/ahas?source_type=nacos_pc_20190225" target="_self" data-reactid="206">Cloud Service AHAS</a></dd></dl></div></div><div class="copyright" data-reactid="207"><span data-reactid="208">@ 2018 The Nacos Authors | An Alibaba Middleware (Aliware) Project</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js">
	</script>
	<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?e3a5cec56ef8619cf9d7c2abebd509e3";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
</body>
</html>