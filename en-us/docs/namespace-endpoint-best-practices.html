<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="namespace,endpoint,best practices" />
	<meta name="description" content="With using Nacos enterprises more and more,the two most frequently encountered problem is:how to use in my production environment right namespace and the endpoint." />
	<!-- 网页标签标题 -->
	<title>Namespace,endpoint best practices</title>
	<link rel="shortcut icon" href="https://img.alicdn.com/tfs/TB1hgJpHAPoK1RjSZKbXXX1IXXa-64-64.png"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/en-us/index.html"><img class="logo" src="/img/nacos_colorful.png"/></a><span class="language-switch language-switch-normal">中</span><div class="header-menu"><img class="header-menu-toggle" src="/img/menu_gray.png"/><ul><li class="menu-item menu-item-normal"><a href="/en-us/index.html">HOME</a></li><li class="menu-item menu-item-normal menu-item-normal-active"><a href="/en-us/docs/quick-start.html">DOCS</a></li><li class="menu-item menu-item-normal"><a href="/en-us/docs/nacos-dev.html">TEAM</a></li><li class="menu-item menu-item-normal"><a href="/en-us/blog">BLOG</a></li><li class="menu-item menu-item-normal"><a href="/en-us/community">COMMUNITY</a></li><li class="menu-item menu-item-normal"><a href="https://mp.weixin.qq.com/s/KH0dEC6cNckoq1M-siiCmg">CAMPUS</a></li><li class="menu-item menu-item-normal"><a href="http://console.nacos.io/nacos/index.html">DEMO-CONSOLE</a></li></ul></div></div></header><div class="bar"><div class="bar-body"><img src="/img/docs.png" class="front-img"/><div class="bar-title"><span>Documentation</span><div class="bone bone-light"></div></div><img src="/img/docs.png" class="back-img"/></div></div><section class="content-section"><div class="content-body"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>Nacos </span><ul><li style="height:180px;overflow:hidden" class="menu-item menu-item-level-2"><span>What is Nacos<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/what-is-nacos.html" target="_self">What is Nacos</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/concepts.html" target="_self">Concepts</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/architecture.html" target="_self">Architecure</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/faq.html" target="_self">FAQ</a></li></ul></li><li style="height:324px;overflow:hidden" class="menu-item menu-item-level-2"><span>Quick Start<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/quick-start.html" target="_self">Nacos</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/quick-start-spring.html" target="_self">Nacos Spring</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/quick-start-spring-boot.html" target="_self">Nacos Spring Boot</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/quick-start-spring-cloud.html" target="_self">Nacos Spring Cloud</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/quick-start-docker.html" target="_self">Nacos Docker</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/use-nacos-with-dubbo.html" target="_self">Nacos with Dubbo</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/use-nacos-with-kubernetes.html" target="_self">Nacos with K8s</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/nacos-sync.html" target="_self">Nacos Sync</a></li></ul></li><li style="height:252px;overflow:hidden" class="menu-item menu-item-level-2"><span>User Guide<img style="transform:rotate(0deg)" class="menu-toggle" src="/img/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/sdk.html" target="_self">Java SDK</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/other-language.html" target="_self">Other Language</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/open-api.html" target="_self">Open-API</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/nacos-spring.html" target="_self">Nacos Spring</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/namespace-endpoint-best-practices.html" target="_self">namespace, endpoint best practices</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/system-configurations.html" target="_self">Nacos System Configurations</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>Admin Guide<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/deployment.html" target="_self">Deployment Guide</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/cluster-mode-quick-start.html" target="_self">Cluster Mode Deployment</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/management-api.html" target="_self">Management OpenAPI</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/console-guide.html" target="_self">Admin Console Guide</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/monitor-guide.html" target="_self">Nacos Monitor Guide</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/nacos-config-benchmark.html" target="_self">Nacos Config Benchmark</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/nacos-naming-benchmark.html" target="_self">Nacos Naming Benchmark</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/nacos-sync-use.html" target="_self">Data Migration to Nacos</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>Contributor Guide<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/contributing.html" target="_self">Contribute to Nacos</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/activity.html" target="_self">Nacos Activity</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/pull-request.html" target="_self">Pull Request Template</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/how-to-reporting-bugs.html" target="_self">How to reporting bugs</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/roadmap.html" target="_self">Nacos RoadMap</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/use-nacos-with-istio.html" target="_self">Nacos with Istio</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>Community<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/community.html" target="_self">Community</a></li></ul></li></ul></li></ul></div><div class="doc-content markdown-body"><h1>Namespace, endpoint best practices</h1>
<p>With using Nacos enterprises more and more, the two most frequently encountered problem is: how to use in my production environment right namespace and the endpoint.</p>
<h2>namespce</h2>
<p>Regarding the namespace, the following main from <strong>namespace design background</strong> and <strong>namespace best practice</strong> two aspects to discuss.</p>
<h3>namespace design background</h3>
<p>Namespace design is made more nacos based on this environment and multi-tenant data (<strong>configuration and service</strong>) of isolation.That is:</p>
<ul>
<li>From the point of view of a tenant (user), if there are many different environment, so this time can be specified according to the environment to create different namespce, in order to realize the environment isolation.For example, you might be everyday, pretest and the production of three different environment, then use a nacos cluster can build the following three different namespace. As shown in the figure below:</li>
</ul>
<p><img src="http://edas.oss-cn-hangzhou.aliyuncs.com/deshao/pictures/nacos_ingle_tenant_namespace.jpg" alt=""></p>
<ul>
<li>from the point of view of multiple tenants (user), each tenant (user) may have its own namespace, each tenant configuration data (user) and registered service data belonging to its own namespace, so as to achieve the multi-tenant isolation between the data.For example the supervisor assigned three tenants, San Zhang, Si Li and Wu Wang respectively.Distribution of good, after all the tenants on their own account name and password after logging in, create your own namespace. As shown in the figure below:</li>
</ul>
<p><img src="http://edas.oss-cn-hangzhou.aliyuncs.com/deshao/pictures/nacos_multi_tenant_namespace.jpg" alt=""></p>
<p><strong>Note:</strong> This feature is still in planning.</p>
<h3>namespace best practices</h3>
<p>Best practices on the namespace, this part mainly consists of two actions:</p>
<ul>
<li>How to obtain the value of the namespace</li>
<li>The namespace parameters initialization method</li>
</ul>
<h3>How to obtain the value of the namespace</h3>
<p>Whether you are based on Spring Cloud or Dubbo to use nacos, involve namespace parameter input, so when the value of the namespace from where can I get?</p>
<ol>
<li>
<p>If you are using is not aware to this parameter in the process of input, then nacos unified will use a default namespace as input, nacos naming will use <strong>public</strong> as the default parameters to initialize, nacos config will use an <strong>empty string</strong> as the default parameters to initialize.</p>
</li>
<li>
<p>If you need to customize your own namespace, then the value how to produce?</p>
<p>Can see on the console function of the left side of the nacos has the function of a <strong>namespace</strong>, click on the <strong>new namespace</strong> can see button, so this time you can create your own namespace.Create success, generates a <strong>namespace ID</strong>, is mainly used to avoid <strong>namespace name</strong> namesake, is likely to happen. So when you need to configure the specified namespace in the application, <strong>fill in it is the namespace ID</strong>.The important things three times:</p>
<ol>
<li>When you need to configure the specified namespace in the application, <strong>fill in it isthe namespace ID</strong>.</li>
<li>When you need to configure the specified namespace in the application, <strong>fill in it isthe namespace ID</strong>.</li>
<li>When you need to configure the specified namespace in the application, <strong>fill in it isthe namespace ID</strong>.</li>
</ol>
</li>
</ol>
<p>Namesace for <strong>public</strong> is nacos a retain control, if you need to create your own namespace, it is best not to <strong>public</strong> and name repetition, to an actual business scenarios have specific semantic named after, lest bring literally a namespace which is not easy to distinguish himself.</p>
<h3>namespace parameters initialization method</h3>
<p>Nacos client for namespace initialization process as shown in the figure below:</p>
<p><img src="http://edas.oss-cn-hangzhou.aliyuncs.com/deshao/pictures/nacos_init_namespace_plus.jpg" alt=""></p>
<p>Nacos client initialization of the namespace contains two main parts:</p>
<ul>
<li>
<p>User mode by nacos client through the properties in the instance structure parameters was introduced into the namespace.</p>
</li>
<li>
<p>In a cloud environment (<strong>Alibaba cloud of EDAS</strong>) of the namespace argument parsing.</p>
<p>By <strong>-Duse.cloud.namespace.parsing=true/false</strong> whether you need to control in a cloud environment automatic parsing namespace parameter, the default value is <strong>true</strong>, is automatically parsed, its purpose is convenient when the user on the cloud can be smooth on the cloud in the form of zero cost.If the user on the cloud under the need to use the self-built nacos namespace, that this time you only need to <strong>-Duse.cloud.namespace.parsing=false</strong>.</p>
</li>
</ul>
<h2>endpoint</h2>
<p>On the endpoint, and mainly from the <strong>the design background of endpoint</strong> and <strong>the endpoint parameters initialization</strong> two aspects to discuss.</p>
<h3>The design background of endpoint</h3>
<p>When nacos server cluster needs to enlarge shrinks, let a client needs to have a kind of ability can timely change perception to the cluster. In a timely manner to perceive the change of the cluster is realized through the endpoint.That the client will be timed to the endpoint sends a request to update the client list in memory clusters.</p>
<h3>The endpoint of the initialization parameter</h3>
<p>Nacos Client provides an endpoint of the incoming parameter rules make sense of it.When through the constructor to initialize the <strong>properties</strong> the endpoint, the specified endpoint value can be a specific value, also can be in the form of a placeholder, as shown below:</p>
<blockquote>
<p><strong>${endpoint.options:defaultValue}</strong>。</p>
</blockquote>
<p>Description:</p>
<ol>
<li><strong>endpoint.options</strong> is a specific variable.Support from the system property, reads the system environment variables.</li>
<li><strong>defaultValue</strong> is given a default value.When is not properly initialized from the specific variables, the given default value is used to initialize.</li>
</ol>
<p>The endpoint of the parsing rules is more complex, the overall flow chart of a parse is as follows:</p>
<p><img src="http://edas.oss-cn-hangzhou.aliyuncs.com/deshao/pictures/nacos_init_endpoint.jpg" alt=""></p>
<p><strong>Description:</strong> Blue special distinction is to support a cloud environment (Alibaba cloud EDAS) automatically from the system environment variables to read in the endpoint value, in order to achieve the user local development or moving applications to the cloud with zero cost on the way to achieve a smooth of cloud.</p>
<p>Description:</p>
<ul>
<li>
<p>Open the endpoint parameters parsing rules</p>
<ol>
<li>
<p>If the initialization Nacos Client, not through the properties to specify the endpoint, this time from the system environment variables in called <strong>ALIBABA_ALIWARE_ENDPOINT_URL</strong> to initialize the specified value, if the system environment variable is not set, so this time will return an empty string.</p>
</li>
<li>
<p>If set the endpoint,</p>
<ol>
<li>
<p>Set the endpoint is a specific value specified.</p>
<p>At this time will be from the system environment variables in the variables called <strong>ALIBABA_ALIWARE_ENDPOINT_URL</strong> to initialize the specified value, if the system environment variables not set, so this time use user mode was introduced into the specific value to initialize the endpoint.</p>
</li>
<li>
<p>Input in the form of a placeholder.</p>
<p>Then parses the concrete placeholder value, then:</p>
<ol>
<li>
<p>In order to value from the system properties and environment variables.</p>
<p>For example,You input is <strong>${nacos.endpoint:defaultValue}</strong>, then parse out a placeholder is <strong>nacos.endpoint</strong>. Parsing comes out, can read first in the System properties (<strong>System.getProperty(&quot;nacos.endpoint&quot;)</strong>) is set up <strong>nacos endpoint</strong> variable values, if not, will be called from the System environment variables in the variables specified <strong>nacos.endpoint</strong> value to initialize.</p>
</li>
<li>
<p>If by parsing out a placeholder is not properly initialized the endpoint, is from the system environment variables in called <strong>ALIBABA_ALIWARE_ENDPOINT_URL</strong> to initialize the specified value.</p>
</li>
<li>
<p>If after the above two steps have not been initialized, then if you set the default value, this time will use the default value to initialize the endpoint, otherwise returned to parse out a placeholder.</p>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>
<p>Close the endpoint parameter parsing rules</p>
<p>When closed the endpoint parameter parsing rules, this time is in user mode in constructing Nacos Client through the properties parameter input values of the endpoint.</p>
</li>
</ul>
<p>By default, Nacos Client is the ability to open the endpoint parameter parsing rules. If you want to close the ability, can be in Nacos Client initialization when the incoming instances of the properties specified in the key to <strong>isUseEndpointParsingRule</strong>, <strong>false</strong> value is can be closed.</p>
</div></div></section><footer class="footer-container"><div class="footer-body"><img src="/img/nacos_gray.png"/><div class="cols-container"><div class="col col-12"><h3>Vision</h3><p>By providing an easy-to-use service infrastructure such as dynamic service discovery, service configuration, service sharing and management and etc., Nacos help users better construct, deliver and manage their own service platform, reuse and composite business service faster and deliver value of business innovation more quickly so as to win market for users in the era of cloud native and in all cloud environments, such as private, mixed, or public clouds.</p></div><div class="col col-6"><dl><dt>Documentation</dt><dd><a href="/en-us/docs/what-is-nacos.html" target="_self">Overview</a></dd><dd><a href="/en-us/docs/quick-start.html" target="_self">Quick start</a></dd><dd><a href="/en-us/docs/contributing.html" target="_self">Developer guide</a></dd></dl></div><div class="col col-6"><dl><dt>Resources</dt><dd><a href="/en-us/community/index.html" target="_self">Community</a></dd><dd><a href="https://www.aliyun.com/product/acm?source_type=nacos_pc_20181219" target="_self">Cloud Service ACM</a></dd><dd><a href="https://www.aliyun.com/product/edas?source_type=nacos_pc_20181219" target="_self">Cloud Service EDAS</a></dd><dd><a href="https://www.aliyun.com/product/ahas?source_type=nacos_pc_20190225" target="_self">Cloud Service AHAS</a></dd></dl></div></div><div class="copyright"><span>@ 2018 The Nacos Authors | An Alibaba Middleware (Aliware) Project</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js"></script>
</body>
</html>