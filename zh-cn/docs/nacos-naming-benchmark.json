{
  "filename": "nacos-naming-benchmark.md",
  "__html": "<h1>Nacos服务发现性能测试报告</h1>\n<h2>测试目的</h2>\n<p>主要了解Nacos的服务发现性能负载和容量，协助我们更好的管理Nacos性能质量，帮助用户更快的运用评估Nacos系统负荷。</p>\n<h2>测试工具</h2>\n<p>我们使用自研的PAS性能评估服务平台进行压测，其原理是基于利用JMeter引擎，使用PAS自动生成的JMeter脚本，进行智能压测。</p>\n<p><img src=\"https://img.alicdn.com/tfs/TB1xCfDDpzqK1RjSZFvXXcB7VXa-692-297.png\" alt=\"IMAGE\"></p>\n<h2>测试环境</h2>\n<h3>1.环境</h3>\n<table>\n<thead>\n<tr>\n<th>指标</th>\n<th>参数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>机器</td>\n<td>CPU 16核，内存32G</td>\n</tr>\n<tr>\n<td>集群规模</td>\n<td>3节点</td>\n</tr>\n<tr>\n<td>Nacos版本</td>\n<td>1.0.0</td>\n</tr>\n</tbody>\n</table>\n<h3>2.设置启动参数</h3>\n<pre><code>/opt/taobao/java/bin/java\t -server\n-Xms20g\n-Xmx20g\n-Xmn10g\t -XX:MetaspaceSize=128m\n-XX:MaxMetaspaceSize=320m\n-XX:-OmitStackTraceInFastThrow\n-XX:+HeapDumpOnOutOfMemoryError\n-XX:HeapDumpPath=/home/admin/nacos/logs/java_heapdump.hprof\n-XX:-UseLargePages\n-Djava.ext.dirs=/opt/taobao/java/jre/lib/ext:/opt/taobao/java/lib/ext:/home/admin/nacos/plugi\nns/cmdb:/home/admin/nacos/plugins/mysql\t -Xloggc:/home/admin/nacos/logs/nacos_gc.log\n-verbose:gc\t -XX:+PrintGCDetails\t -XX:+PrintGCDateStamps\t -XX:+PrintGCTimeStamps\n-XX:+UseGCLogFileRotation\n-XX:NumberOfGCLogFiles=10\t -XX:GCLogFileSize=100M\t -Xdebug\n-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8000\n-Dnacos.home=/home/admin/nacos\t -jar\t /home/admin/nacos/target/nacos-server.jar\n--spring.config.location=classpath:/,classpath:/config/,file:./,file:./config/,file:/home/admin/naco\ns/conf/\t--logging.config=/home/admin/nacos/conf/nacos-logback.xml\tnacos.nacos\n</code></pre>\n<h2>测试场景</h2>\n<p>以下测试场景都是服务发现重要接口：</p>\n<ul>\n<li>验证Nacos服务发现注册实例的能力</li>\n<li>验证Nacos服务发现查询实例的能力</li>\n<li>验证Nacos服务发现注销实例的能力</li>\n</ul>\n<h2>测试数据</h2>\n<h3>1. 注册实例</h3>\n<p>Nacos服务发现注册实例接口的性能，调用HTTP接口测试。\n实测3节点集群不同压力下的性能表现：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">机器*并发数</th>\n<th style=\"text-align:center\">服务数</th>\n<th style=\"text-align:center\">注册实例数</th>\n<th style=\"text-align:center\">TPS</th>\n<th style=\"text-align:center\">RT(ms)</th>\n<th style=\"text-align:center\">最小RT(ms)</th>\n<th style=\"text-align:center\">最大RT(ms)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1*100</td>\n<td style=\"text-align:center\">80301</td>\n<td style=\"text-align:center\">84965</td>\n<td style=\"text-align:center\">1793.41</td>\n<td style=\"text-align:center\">54.63</td>\n<td style=\"text-align:center\">0.8</td>\n<td style=\"text-align:center\">1200.86</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3*50</td>\n<td style=\"text-align:center\">529321</td>\n<td style=\"text-align:center\">819226</td>\n<td style=\"text-align:center\">12574.8</td>\n<td style=\"text-align:center\">15.8</td>\n<td style=\"text-align:center\">0.45</td>\n<td style=\"text-align:center\">3499.59</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4*50</td>\n<td style=\"text-align:center\">609726</td>\n<td style=\"text-align:center\">836870</td>\n<td style=\"text-align:center\">13000</td>\n<td style=\"text-align:center\">18.54</td>\n<td style=\"text-align:center\">0.46</td>\n<td style=\"text-align:center\">3038.48</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4*100</td>\n<td style=\"text-align:center\">777262</td>\n<td style=\"text-align:center\">927169</td>\n<td style=\"text-align:center\">13257</td>\n<td style=\"text-align:center\">35.65</td>\n<td style=\"text-align:center\">0.48</td>\n<td style=\"text-align:center\">3231.2</td>\n</tr>\n</tbody>\n</table>\n<h3>2. 查询实例</h3>\n<p>Nacos服务发现查询实例接口的性能，调用HTTP接口测试。\n实测3节点集群不同压力下的性能表现：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">机器*并发数</th>\n<th style=\"text-align:center\">服务数</th>\n<th style=\"text-align:center\">注册实例数</th>\n<th style=\"text-align:center\">TPS</th>\n<th style=\"text-align:center\">RT(ms)</th>\n<th style=\"text-align:center\">最小RT(ms)</th>\n<th style=\"text-align:center\">最大RT(ms)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1*100</td>\n<td style=\"text-align:center\">80301</td>\n<td style=\"text-align:center\">84965</td>\n<td style=\"text-align:center\">3092.16</td>\n<td style=\"text-align:center\">30.86</td>\n<td style=\"text-align:center\">0.81</td>\n<td style=\"text-align:center\">509.4</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3*50</td>\n<td style=\"text-align:center\">529321</td>\n<td style=\"text-align:center\">819226</td>\n<td style=\"text-align:center\">12574.8</td>\n<td style=\"text-align:center\">15.8</td>\n<td style=\"text-align:center\">0.45</td>\n<td style=\"text-align:center\">3499.59</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4*50</td>\n<td style=\"text-align:center\">609726</td>\n<td style=\"text-align:center\">836870</td>\n<td style=\"text-align:center\">15603</td>\n<td style=\"text-align:center\">16.41</td>\n<td style=\"text-align:center\">0.42</td>\n<td style=\"text-align:center\">3042.17</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4*100</td>\n<td style=\"text-align:center\">777262</td>\n<td style=\"text-align:center\">927169</td>\n<td style=\"text-align:center\">13604</td>\n<td style=\"text-align:center\">34.19</td>\n<td style=\"text-align:center\">0.43</td>\n<td style=\"text-align:center\">3434.1</td>\n</tr>\n</tbody>\n</table>\n<h3>3. 注销实例</h3>\n<p>Nacos服务发现注销实例接口的性能，调用HTTP接口测试。\n实测3节点集群不同压力下的性能表现：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">机器*并发数</th>\n<th style=\"text-align:center\">服务数</th>\n<th style=\"text-align:center\">注册实例数</th>\n<th style=\"text-align:center\">TPS</th>\n<th style=\"text-align:center\">RT(ms)</th>\n<th style=\"text-align:center\">最小RT(ms)</th>\n<th style=\"text-align:center\">最大RT(ms)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1*100</td>\n<td style=\"text-align:center\">80301</td>\n<td style=\"text-align:center\">84965</td>\n<td style=\"text-align:center\">1118.95</td>\n<td style=\"text-align:center\">14.08</td>\n<td style=\"text-align:center\">0.7</td>\n<td style=\"text-align:center\">597.43</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3*50</td>\n<td style=\"text-align:center\">529321</td>\n<td style=\"text-align:center\">819226</td>\n<td style=\"text-align:center\">14508.53</td>\n<td style=\"text-align:center\">11.23</td>\n<td style=\"text-align:center\">0.4</td>\n<td style=\"text-align:center\">3274.49</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4*50</td>\n<td style=\"text-align:center\">609726</td>\n<td style=\"text-align:center\">836870</td>\n<td style=\"text-align:center\">15476.93</td>\n<td style=\"text-align:center\">16.02</td>\n<td style=\"text-align:center\">0.38</td>\n<td style=\"text-align:center\">3106.23</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4*100</td>\n<td style=\"text-align:center\">777262</td>\n<td style=\"text-align:center\">927169</td>\n<td style=\"text-align:center\">11940.9</td>\n<td style=\"text-align:center\">40.33</td>\n<td style=\"text-align:center\">0.42</td>\n<td style=\"text-align:center\">51052.46</td>\n</tr>\n</tbody>\n</table>\n<h2>测试结论</h2>\n<p>Nacos服务发现性能测试都是针对重点功能，通过对3节点规模集群进行压测，可以看到接口性能负载和容量。</p>\n<ol>\n<li>压测容量服务数可达60W，实例注册数达110W，集群运行持续稳定，达到预期；(注: 由于本次注册实例使用的是HTTP接口, 并没有将心跳上报的TPS包括在内, 如果要支持百万实例的心跳上报, 需要集群水平扩容, 并调优tomcat和内核参数)</li>\n<li>注册/查询实例TPS达到 13000 以上，接口达到预期；</li>\n</ol>\n<p>本次只测试临时实例注册/查询/注销，未涉及持久实例(后续输出)；</p>\n<p>本测试供给大家作为参考，如有不足或偏差，请指正!\n如果对性能有其他需求，可以给我们提issue。</p>\n",
  "link": "/zh-cn/docs/nacos-naming-benchmark.html",
  "meta": {
    "title": "Nacos服务发现性能测试报告",
    "keywords": "Nacos,服务,发现,性能",
    "description": "Nacos服务发现性能测试报告"
  }
}